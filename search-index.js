crystal_doc_search_index_callback({"repository_name":"github.com/oguzbilgic/zincir-crystal","body":"# Zincir\n\nSimple distributed blockchain experiment written in [Crystal](https://crystal-lang.org)\n\n - [Documents](http://docs.zincir.xyz)\n - [Releases](https://github.com/oguzbilgic/zincir-crystal/releases)\n - [Network Explorer](http://explorer.zincir.xyz)\n\n## Usage\n\n### Build\n\nTo build zincir, you will need [Crystal](https://crystal-lang.org/) and\n[OpenSSL](https://www.openssl.org/) installed on your system. You can use\n[Homebrew](https://brew.sh/) on Mac to install these dependencies.\n\n```bash\n> git clone git@github.com:oguzbilgic/zincir-crystal.git\n  ...\n> shards install\n  ...\n> shards build --release\n  Dependencies are satisfied\n  Building: zincird\n```\n\n### Options\n\n```shell\n> ./bin/zincird --help\n  Usage: zincir [arguments]\n      -s IP, --seed-ip=IP              First node to connect, TestNet by default\n      -i IP, --host-ip=IP              Node's public ip, If the node is public\n      -p PORT, --port=PORT             Node's public port, If the node is public\n      -l, --local-net                  Prevents node from connecting to public nodes\n      -w, --web                        Start web server without making the node public\n      -m, --mine                       Enable mining\n      -h, --help                       Show this help\n      -v, --version                    Show node version\n```\n\n### Start\n\n```bash\n> ./bin/zincird --mine\n  Connecting to testnet.zincir.xyz:9147\n  Added <1-0878bff02..ec7> 1544946023\n  ...\n```\n\nNode will connect to `TestNet` by default and sync the blockchain, before mining.\nBlockchain will be cached in `./blocks/` folder.\n\n### Start a public node\n\n```bash\n> ./bin/zincird --ip mynode.mywebsite.com --port 1234 --mine\n  Connecting to testnet.zincir.xyz:9147\n  Added <1-0878bff02..ec7> 1544946023\n  ...\n```\n\nIn public mode, node will advertise it's ip and host to the network for other\nnodes to connect. Therefore, node needs to be publicly accessible with the\nprovided ip and port configuration\n\n## Development\n\n### Run tests\n\n```bash\n$ crystal spec\n  ...\n```\n","program":{"html_id":"github.com/oguzbilgic/zincir-crystal/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","path":"Zincir.html","kind":"module","full_name":"Zincir","name":"Zincir","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/emitter.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/emitter.cr"},{"filename":"zincir/difficulty.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr"},{"filename":"zincir/block.cr","line_number":4,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr"},{"filename":"zincir/blockchain.cr","line_number":5,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr"},{"filename":"zincir/cli.cr","line_number":3,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr"},{"filename":"zincir/miner.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/miner.cr"},{"filename":"zincir/network.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr"},{"filename":"zincir/node.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr"},{"filename":"zincir/web.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/web.cr"},{"filename":"zincir/blockchain/array.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr"},{"filename":"zincir/blockchain/tree.cr","line_number":4,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr"},{"filename":"zincir/storage/file.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/file.cr"},{"filename":"zincir/storage/network.cr","line_number":1,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr"},{"filename":"zincir.cr","line_number":11,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"VERSION","name":"VERSION","value":"\"0.7.0\"","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Block","path":"Zincir/Block.html","kind":"class","full_name":"Zincir::Block","name":"Block","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/block.cr","line_number":5,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[{"id":"calculate_hash(nonce:String,index:String,timestamp:String,data,previous_hash)-class-method","html_id":"calculate_hash(nonce:String,index:String,timestamp:String,data,previous_hash)-class-method","name":"calculate_hash","doc":"Returns the hash of the `Block` with the given *nonce*","summary":"<p>Returns the hash of the <code><a href=\"../Zincir/Block.html\">Block</a></code> with the given <em>nonce</em></p>","abstract":false,"args":[{"name":"nonce","doc":null,"default_value":"","external_name":"nonce","restriction":"String"},{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":"String"},{"name":"timestamp","doc":null,"default_value":"","external_name":"timestamp","restriction":"String"},{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":""},{"name":"previous_hash","doc":null,"default_value":"","external_name":"previous_hash","restriction":""}],"args_string":"(nonce : String, index : String, timestamp : String, data, previous_hash)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L72","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L72","def":{"name":"calculate_hash","args":[{"name":"nonce","doc":null,"default_value":"","external_name":"nonce","restriction":"String"},{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":"String"},{"name":"timestamp","doc":null,"default_value":"","external_name":"timestamp","restriction":"String"},{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":""},{"name":"previous_hash","doc":null,"default_value":"","external_name":"previous_hash","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"hash = OpenSSL::Digest.new(\"SHA256\")\nhash.update((((nonce + index) + timestamp) + data) + previous_hash)\nhash.hexdigest\n"}},{"id":"first-class-method","html_id":"first-class-method","name":"first","doc":"Returns the first `Block` of the chain","summary":"<p>Returns the first <code><a href=\"../Zincir/Block.html\">Block</a></code> of the chain</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L32","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L32","def":{"name":"first","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Block.new(0, 0_i64, \"Genesis\", \"0\", \"0\")"}},{"id":"next(previous,difficulty,data)-class-method","html_id":"next(previous,difficulty,data)-class-method","name":"next","doc":null,"summary":null,"abstract":false,"args":[{"name":"previous","doc":null,"default_value":"","external_name":"previous","restriction":""},{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":""}],"args_string":"(previous, difficulty, data)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L36","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L36","def":{"name":"next","args":[{"name":"previous","doc":null,"default_value":"","external_name":"previous","restriction":""},{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Block.new(previous.index + 1, Time.now.to_unix, data, previous.hash, difficulty)"}}],"constructors":[{"id":"new(index,timestamp,data,previous_hash,difficulty,nonce=nil)-class-method","html_id":"new(index,timestamp,data,previous_hash,difficulty,nonce=nil)-class-method","name":"new","doc":"Creates a `Block` with the given information and solves the hash\n\nTODO: Verify if the difficulty is valid","summary":"<p>Creates a <code><a href=\"../Zincir/Block.html\">Block</a></code> with the given information and solves the hash</p>","abstract":false,"args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""},{"name":"timestamp","doc":null,"default_value":"","external_name":"timestamp","restriction":""},{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":""},{"name":"previous_hash","doc":null,"default_value":"","external_name":"previous_hash","restriction":""},{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"nonce","doc":null,"default_value":"nil","external_name":"nonce","restriction":""}],"args_string":"(index, timestamp, data, previous_hash, difficulty, nonce = <span class=\"n\">nil</span>)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L21","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L21","def":{"name":"new","args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""},{"name":"timestamp","doc":null,"default_value":"","external_name":"timestamp","restriction":""},{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":""},{"name":"previous_hash","doc":null,"default_value":"","external_name":"previous_hash","restriction":""},{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"nonce","doc":null,"default_value":"nil","external_name":"nonce","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(index, timestamp, data, previous_hash, difficulty, nonce)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}},{"id":"new(__temp_42:JSON::PullParser)-class-method","html_id":"new(__temp_42:JSON::PullParser)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"__temp_42","doc":null,"default_value":"","external_name":"__temp_42","restriction":"::JSON::PullParser"}],"args_string":"(__temp_42 : JSON::PullParser)","source_link":null,"source_link":null,"def":{"name":"new","args":[{"name":"__temp_42","doc":null,"default_value":"","external_name":"__temp_42","restriction":"::JSON::PullParser"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(__temp_42)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":">(b)-instance-method","html_id":"&gt;(b)-instance-method","name":">","doc":null,"summary":null,"abstract":false,"args":[{"name":"b","doc":null,"default_value":"","external_name":"b","restriction":""}],"args_string":"(b)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L67","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L67","def":{"name":">","args":[{"name":"b","doc":null,"default_value":"","external_name":"b","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"index > b.index"}},{"id":"calculate_hash(nonce)-instance-method","html_id":"calculate_hash(nonce)-instance-method","name":"calculate_hash","doc":null,"summary":null,"abstract":false,"args":[{"name":"nonce","doc":null,"default_value":"","external_name":"nonce","restriction":""}],"args_string":"(nonce)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L63","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L63","def":{"name":"calculate_hash","args":[{"name":"nonce","doc":null,"default_value":"","external_name":"nonce","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Block.calculate_hash(nonce.to_s, @index.to_s, @timestamp.to_s, @data, @previous_hash)"}},{"id":"data:String-instance-method","html_id":"data:String-instance-method","name":"data","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":null,"source_link":null,"def":{"name":"data","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@data"}},{"id":"difficulty:String-instance-method","html_id":"difficulty:String-instance-method","name":"difficulty","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":null,"source_link":null,"def":{"name":"difficulty","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@difficulty"}},{"id":"hash:String-instance-method","html_id":"hash:String-instance-method","name":"hash","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":null,"source_link":null,"def":{"name":"hash","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@hash"}},{"id":"index:Int32-instance-method","html_id":"index:Int32-instance-method","name":"index","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":null,"source_link":null,"def":{"name":"index","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int32","visibility":"Public","body":"@index"}},{"id":"mined_by_us=(mined_by_us)-instance-method","html_id":"mined_by_us=(mined_by_us)-instance-method","name":"mined_by_us=","doc":null,"summary":null,"abstract":false,"args":[{"name":"mined_by_us","doc":null,"default_value":"","external_name":"mined_by_us","restriction":""}],"args_string":"(mined_by_us)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L6","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L6","def":{"name":"mined_by_us=","args":[{"name":"mined_by_us","doc":null,"default_value":"","external_name":"mined_by_us","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@mined_by_us = mined_by_us"}},{"id":"mined_by_us?:Bool-instance-method","html_id":"mined_by_us?:Bool-instance-method","name":"mined_by_us?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L6","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L6","def":{"name":"mined_by_us?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@mined_by_us"}},{"id":"nonce:Int32-instance-method","html_id":"nonce:Int32-instance-method","name":"nonce","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":null,"source_link":null,"def":{"name":"nonce","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int32","visibility":"Public","body":"@nonce"}},{"id":"previous_hash:String-instance-method","html_id":"previous_hash:String-instance-method","name":"previous_hash","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":null,"source_link":null,"def":{"name":"previous_hash","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@previous_hash"}},{"id":"solve_block(difficulty,nonce=0)-instance-method","html_id":"solve_block(difficulty,nonce=0)-instance-method","name":"solve_block","doc":"Solves the hash with the given *difficulty* and *nonce*","summary":"<p>Solves the hash with the given <em>difficulty</em> and <em>nonce</em></p>","abstract":false,"args":[{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"nonce","doc":null,"default_value":"0","external_name":"nonce","restriction":""}],"args_string":"(difficulty, nonce = <span class=\"n\">0</span>)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L52","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L52","def":{"name":"solve_block","args":[{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"nonce","doc":null,"default_value":"0","external_name":"nonce","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"loop do\n  hash = calculate_hash(nonce)\n  if Difficulty.satisfies?(hash, difficulty)\n    return {nonce, hash}\n  end\n  nonce = nonce + 1\n  Fiber.yield\nend"}},{"id":"timestamp:Int64-instance-method","html_id":"timestamp:Int64-instance-method","name":"timestamp","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int64","source_link":null,"source_link":null,"def":{"name":"timestamp","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int64","visibility":"Public","body":"@timestamp"}},{"id":"to_json(json:JSON::Builder)-instance-method","html_id":"to_json(json:JSON::Builder)-instance-method","name":"to_json","doc":null,"summary":null,"abstract":false,"args":[{"name":"json","doc":null,"default_value":"","external_name":"json","restriction":"::JSON::Builder"}],"args_string":"(json : JSON::Builder)","source_link":null,"source_link":null,"def":{"name":"to_json","args":[{"name":"json","doc":null,"default_value":"","external_name":"json","restriction":"::JSON::Builder"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"json.object do\n  _index = @index\n  if _index.nil?\n  else\n    json.field(\"index\") do\n      _index.to_json(json)\n    end\n  end\n  _timestamp = @timestamp\n  if _timestamp.nil?\n  else\n    json.field(\"timestamp\") do\n      _timestamp.to_json(json)\n    end\n  end\n  _data = @data\n  if _data.nil?\n  else\n    json.field(\"data\") do\n      _data.to_json(json)\n    end\n  end\n  _previous_hash = @previous_hash\n  if _previous_hash.nil?\n  else\n    json.field(\"previous_hash\") do\n      _previous_hash.to_json(json)\n    end\n  end\n  _difficulty = @difficulty\n  if _difficulty.nil?\n  else\n    json.field(\"difficulty\") do\n      _difficulty.to_json(json)\n    end\n  end\n  _nonce = @nonce\n  if _nonce.nil?\n  else\n    json.field(\"nonce\") do\n      _nonce.to_json(json)\n    end\n  end\n  _hash = @hash\n  if _hash.nil?\n  else\n    json.field(\"hash\") do\n      _hash.to_json(json)\n    end\n  end\nend"}},{"id":"to_s(io)-instance-method","html_id":"to_s(io)-instance-method","name":"to_s","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L40","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L40","def":{"name":"to_s","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"io << \"<#{index}-#{@hash[0..15]}..#{@hash[-3..-1]}@#{@timestamp}>\""}},{"id":"valid?-instance-method","html_id":"valid?-instance-method","name":"valid?","doc":"Returns true if `Block#hash` can be calculcated with the `Block#nonce`\n\nNOTE: Should we check if `#hash` satisfies the `#difficulty`?","summary":"<p>Returns true if <code><a href=\"../Zincir/Block.html#hash%3AString-instance-method\">Block#hash</a></code> can be calculcated with the <code><a href=\"../Zincir/Block.html#nonce%3AInt32-instance-method\">Block#nonce</a></code></p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L47","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/block.cr#L47","def":{"name":"valid?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@hash == (calculate_hash(@nonce))"}}],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","path":"Zincir/Blockchain.html","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain","abstract":true,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/blockchain.cr","line_number":6,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"BLOCK_DURATION","name":"BLOCK_DURATION","value":"60.0","doc":"Desired time between blocks","summary":"<p>Desired time between blocks</p>"},{"id":"UPDATE_FREQUENCY","name":"UPDATE_FREQUENCY","value":"60","doc":"Number of blocks between difficulty adjustments","summary":"<p>Number of blocks between difficulty adjustments</p>"}],"included_modules":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"}],"extended_modules":[],"subclasses":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/Array","kind":"class","full_name":"Zincir::Blockchain::Array","name":"Array"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/Tree","kind":"class","full_name":"Zincir::Blockchain::Tree","name":"Tree"}],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"block_at(index)-instance-method","html_id":"block_at(index)-instance-method","name":"block_at","doc":"Returns the `Block` at *index*","summary":"<p>Returns the <code><a href=\"../Zincir/Block.html\">Block</a></code> at <em>index</em></p>","abstract":true,"args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"args_string":"(index)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L23","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L23","def":{"name":"block_at","args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"blocks_at(indexes:Enumerable(Int32))-instance-method","html_id":"blocks_at(indexes:Enumerable(Int32))-instance-method","name":"blocks_at","doc":null,"summary":null,"abstract":false,"args":[{"name":"indexes","doc":null,"default_value":"","external_name":"indexes","restriction":"Enumerable(Int32)"}],"args_string":"(indexes : Enumerable(Int32))","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L28","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L28","def":{"name":"blocks_at","args":[{"name":"indexes","doc":null,"default_value":"","external_name":"indexes","restriction":"Enumerable(Int32)"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"indexes = indexes.select do |index|\n  index <= last.index\nend\nindexes.map do |index|\n  block_at(index)\nend\n"}},{"id":"last-instance-method","html_id":"last-instance-method","name":"last","doc":"Returns the last `Block` in the blockchain","summary":"<p>Returns the last <code><a href=\"../Zincir/Block.html\">Block</a></code> in the blockchain</p>","abstract":true,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L20","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L20","def":{"name":"last","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"next_difficulty-instance-method","html_id":"next_difficulty-instance-method","name":"next_difficulty","doc":"Returns the required difficulty for the next `Block`","summary":"<p>Returns the required difficulty for the next <code><a href=\"../Zincir/Block.html\">Block</a></code></p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L39","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L39","def":{"name":"next_difficulty","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"next_difficulty_at(last)"}},{"id":"next_index-instance-method","html_id":"next_index-instance-method","name":"next_index","doc":"Returns the index of the expected `Block`","summary":"<p>Returns the index of the expected <code><a href=\"../Zincir/Block.html\">Block</a></code></p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L44","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L44","def":{"name":"next_index","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"last.index + 1"}},{"id":"queue_block(block)-instance-method","html_id":"queue_block(block)-instance-method","name":"queue_block","doc":"Queues the *block* to be added to the blockchain","summary":"<p>Queues the <em>block</em> to be added to the blockchain</p>","abstract":true,"args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"args_string":"(block)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L26","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr#L26","def":{"name":"queue_block","args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}}],"macros":[],"types":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/Array","path":"Zincir/Blockchain/Array.html","kind":"class","full_name":"Zincir::Blockchain::Array","name":"Array","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/blockchain/array.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":"Creates a blockchain with the first block","summary":"<p>Creates a blockchain with the first block</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L4","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L4","def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"block_at(index)-instance-method","html_id":"block_at(index)-instance-method","name":"block_at","doc":"Returns the `Block` at *index*","summary":"<p>Returns the <code><a href=\"../../Zincir/Block.html\">Block</a></code> at <em>index</em></p>","abstract":false,"args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"args_string":"(index)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L15","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L15","def":{"name":"block_at","args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@blocks[index]"}},{"id":"last-instance-method","html_id":"last-instance-method","name":"last","doc":"Returns the last `Block` in the blockchain","summary":"<p>Returns the last <code><a href=\"../../Zincir/Block.html\">Block</a></code> in the blockchain</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L10","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L10","def":{"name":"last","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@blocks.last"}},{"id":"queue_block(block)-instance-method","html_id":"queue_block(block)-instance-method","name":"queue_block","doc":"Queues the *block* to be added to the blockchain","summary":"<p>Queues the <em>block</em> to be added to the blockchain</p>","abstract":false,"args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"args_string":"(block)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L20","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/array.cr#L20","def":{"name":"queue_block","args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"begin\n  @queued_blocks << block\n  while !@queued_blocks.empty?\n    first_block = @queued_blocks.sort_by!(&.index).shift\n    add_block(first_block)\n  end\nrescue BlockIndexTooHigh\n  @queued_blocks << first_block.not_nil!\nend"}}],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockIndexTooHigh","path":"Zincir/Blockchain/BlockIndexTooHigh.html","kind":"class","full_name":"Zincir::Blockchain::BlockIndexTooHigh","name":"BlockIndexTooHigh","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotAdded","kind":"class","full_name":"Zincir::Blockchain::BlockNotAdded","name":"BlockNotAdded"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotAdded","kind":"class","full_name":"Zincir::Blockchain::BlockNotAdded","name":"BlockNotAdded"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/blockchain.cr","line_number":8,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotAdded","path":"Zincir/Blockchain/BlockNotAdded.html","kind":"class","full_name":"Zincir::Blockchain::BlockNotAdded","name":"BlockNotAdded","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/blockchain.cr","line_number":7,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockIndexTooHigh","kind":"class","full_name":"Zincir::Blockchain::BlockIndexTooHigh","name":"BlockIndexTooHigh"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotPreferred","kind":"class","full_name":"Zincir::Blockchain::BlockNotPreferred","name":"BlockNotPreferred"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockOnForkChain","kind":"class","full_name":"Zincir::Blockchain::BlockOnForkChain","name":"BlockOnForkChain"}],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotPreferred","path":"Zincir/Blockchain/BlockNotPreferred.html","kind":"class","full_name":"Zincir::Blockchain::BlockNotPreferred","name":"BlockNotPreferred","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotAdded","kind":"class","full_name":"Zincir::Blockchain::BlockNotAdded","name":"BlockNotAdded"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotAdded","kind":"class","full_name":"Zincir::Blockchain::BlockNotAdded","name":"BlockNotAdded"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/blockchain.cr","line_number":9,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockOnForkChain","path":"Zincir/Blockchain/BlockOnForkChain.html","kind":"class","full_name":"Zincir::Blockchain::BlockOnForkChain","name":"BlockOnForkChain","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotAdded","kind":"class","full_name":"Zincir::Blockchain::BlockNotAdded","name":"BlockNotAdded"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/BlockNotAdded","kind":"class","full_name":"Zincir::Blockchain::BlockNotAdded","name":"BlockNotAdded"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/blockchain.cr","line_number":10,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain/Tree","path":"Zincir/Blockchain/Tree.html","kind":"class","full_name":"Zincir::Blockchain::Tree","name":"Tree","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/blockchain/tree.cr","line_number":5,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":"Creates a blockchain with the first block","summary":"<p>Creates a blockchain with the first block</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L23","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L23","def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"block_at(index)-instance-method","html_id":"block_at(index)-instance-method","name":"block_at","doc":"Returns the `Block` at *index*\n\nNOTE: This finds the correct block comparing the branch property of\nthe tip block and the blocks at the given index. There might be a \neasier way to find the block","summary":"<p>Returns the <code><a href=\"../../Zincir/Block.html\">Block</a></code> at <em>index</em></p>","abstract":false,"args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"args_string":"(index)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L41","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L41","def":{"name":"block_at","args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"chains = @chains_by_index[index].map do |chain|\n  intersection = (chain.branches & highest_chain.branches)\n  difference = ((highest_chain.branches + chain.branches) - intersection).uniq\n  count = intersection.size - difference.size\n  {chain: chain, count: count}\nend\nchains.sort_by(&.[](\"count\")).last[\"chain\"].block\n"}},{"id":"last-instance-method","html_id":"last-instance-method","name":"last","doc":"Returns the last `Block` in the blockchain","summary":"<p>Returns the last <code><a href=\"../../Zincir/Block.html\">Block</a></code> in the blockchain</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L32","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L32","def":{"name":"last","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"highest_chain.not_nil!.block"}},{"id":"queue_block(block:Block)-instance-method","html_id":"queue_block(block:Block)-instance-method","name":"queue_block","doc":"Queues the *block* to be added to the blockchain","summary":"<p>Queues the <em>block</em> to be added to the blockchain</p>","abstract":false,"args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":"Block"}],"args_string":"(block : Block)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L54","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L54","def":{"name":"queue_block","args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":"Block"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if @chains_by_hash[block.hash]?\n  return\nend\nadd_chain(block)\n"}},{"id":"tips:Array(Zincir::Blockchain::Tree::Chain)-instance-method","html_id":"tips:Array(Zincir::Blockchain::Tree::Chain)-instance-method","name":"tips","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Array(Zincir::Blockchain::Tree::Chain)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L64","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/blockchain/tree.cr#L64","def":{"name":"tips","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@tips"}}],"macros":[],"types":[]}]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Cli","path":"Zincir/Cli.html","kind":"module","full_name":"Zincir::Cli","name":"Cli","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/cli.cr","line_number":4,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[{"id":"run!(args:Array(String))-class-method","html_id":"run!(args:Array(String))-class-method","name":"run!","doc":null,"summary":null,"abstract":false,"args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":"Array(String)"}],"args_string":"(args : Array(String))","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L14","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L14","def":{"name":"run!","args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":"Array(String)"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"options = Options.new\nOptionParser.parse(args) do |parser|\n  parser.banner = \"Usage: zincir [arguments]\"\n  parser.on(\"-s IP\", \"--seed-ip=IP\", \"First node to connect, TestNet by default\") do |i|\n    options.seed_ip = i\n  end\n  parser.on(\"-i IP\", \"--host-ip=IP\", \"Node's public ip, If the node is public\") do |i|\n    options.host_ip = i\n  end\n  parser.on(\"-p PORT\", \"--port=PORT\", \"Node's public port, If the node is public\") do |i|\n    options.port = i.to_i\n  end\n  parser.on(\"-l\", \"--local-net\", \"Prevents node from connecting to public nodes\") do |i|\n    options.local = true\n  end\n  parser.on(\"-w\", \"--web\", \"Start web server without making the node public\") do |i|\n    options.web = true\n  end\n  parser.on(\"-m\", \"--mine\", \"Enable mining\") do\n    options.mine = true\n  end\n  parser.on(\"-h\", \"--help\", \"Show this help\") do\n    puts(parser)\n    exit\n  end\n  parser.on(\"-v\", \"--version\", \"Show node version\") do\n    puts(\"zincir-crystal v#{VERSION}\")\n    exit(0)\n  end\nend\nrun!(options)\n"}},{"id":"run!(options:Options)-class-method","html_id":"run!(options:Options)-class-method","name":"run!","doc":null,"summary":null,"abstract":false,"args":[{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":"Options"}],"args_string":"(options : Options)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L41","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L41","def":{"name":"run!","args":[{"name":"options","doc":null,"default_value":"","external_name":"options","restriction":"Options"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"blockchain = Blockchain::Tree.new\nseed_ip = options.local? ? nil : options.seed_ip\nnetwork = Network.new(seed_ip)\nStorage::File.load_and_sync(blockchain)\nStorage::Network.load_and_sync(blockchain, network)\nif (options.web? || options.port) || options.host_ip\n  spawn(Web.start!(network, blockchain, options.port, options.host_ip))\nend\nif options.mine?\n  spawn(Miner.start!(blockchain))\nend\nsleep\n"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Cli/Options","path":"Zincir/Cli/Options.html","kind":"class","full_name":"Zincir::Cli::Options","name":"Options","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/cli.cr","line_number":5,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Cli","kind":"module","full_name":"Zincir::Cli","name":"Cli"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"host_ip:String?-instance-method","html_id":"host_ip:String?-instance-method","name":"host_ip","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String?","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L7","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L7","def":{"name":"host_ip","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String | ::Nil","visibility":"Public","body":"@host_ip"}},{"id":"host_ip=(host_ip:String?)-instance-method","html_id":"host_ip=(host_ip:String?)-instance-method","name":"host_ip=","doc":null,"summary":null,"abstract":false,"args":[{"name":"host_ip","doc":null,"default_value":"","external_name":"host_ip","restriction":"String | ::Nil"}],"args_string":"(host_ip : String?)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L7","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L7","def":{"name":"host_ip=","args":[{"name":"host_ip","doc":null,"default_value":"","external_name":"host_ip","restriction":"String | ::Nil"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@host_ip = host_ip"}},{"id":"local=(local)-instance-method","html_id":"local=(local)-instance-method","name":"local=","doc":null,"summary":null,"abstract":false,"args":[{"name":"local","doc":null,"default_value":"","external_name":"local","restriction":""}],"args_string":"(local)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L11","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L11","def":{"name":"local=","args":[{"name":"local","doc":null,"default_value":"","external_name":"local","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@local = local"}},{"id":"local?:Bool-instance-method","html_id":"local?:Bool-instance-method","name":"local?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L11","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L11","def":{"name":"local?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@local"}},{"id":"mine=(mine)-instance-method","html_id":"mine=(mine)-instance-method","name":"mine=","doc":null,"summary":null,"abstract":false,"args":[{"name":"mine","doc":null,"default_value":"","external_name":"mine","restriction":""}],"args_string":"(mine)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L9","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L9","def":{"name":"mine=","args":[{"name":"mine","doc":null,"default_value":"","external_name":"mine","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@mine = mine"}},{"id":"mine?:Bool-instance-method","html_id":"mine?:Bool-instance-method","name":"mine?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L9","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L9","def":{"name":"mine?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@mine"}},{"id":"port:Int32?-instance-method","html_id":"port:Int32?-instance-method","name":"port","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32?","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L8","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L8","def":{"name":"port","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int32 | ::Nil","visibility":"Public","body":"@port"}},{"id":"port=(port:Int32?)-instance-method","html_id":"port=(port:Int32?)-instance-method","name":"port=","doc":null,"summary":null,"abstract":false,"args":[{"name":"port","doc":null,"default_value":"","external_name":"port","restriction":"Int32 | ::Nil"}],"args_string":"(port : Int32?)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L8","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L8","def":{"name":"port=","args":[{"name":"port","doc":null,"default_value":"","external_name":"port","restriction":"Int32 | ::Nil"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@port = port"}},{"id":"seed_ip:String-instance-method","html_id":"seed_ip:String-instance-method","name":"seed_ip","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L6","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L6","def":{"name":"seed_ip","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@seed_ip"}},{"id":"seed_ip=(seed_ip)-instance-method","html_id":"seed_ip=(seed_ip)-instance-method","name":"seed_ip=","doc":null,"summary":null,"abstract":false,"args":[{"name":"seed_ip","doc":null,"default_value":"","external_name":"seed_ip","restriction":""}],"args_string":"(seed_ip)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L6","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L6","def":{"name":"seed_ip=","args":[{"name":"seed_ip","doc":null,"default_value":"","external_name":"seed_ip","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@seed_ip = seed_ip"}},{"id":"web=(web)-instance-method","html_id":"web=(web)-instance-method","name":"web=","doc":null,"summary":null,"abstract":false,"args":[{"name":"web","doc":null,"default_value":"","external_name":"web","restriction":""}],"args_string":"(web)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L10","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L10","def":{"name":"web=","args":[{"name":"web","doc":null,"default_value":"","external_name":"web","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@web = web"}},{"id":"web?:Bool-instance-method","html_id":"web?:Bool-instance-method","name":"web?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L10","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/cli.cr#L10","def":{"name":"web?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@web"}}],"macros":[],"types":[]}]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Difficulty","path":"Zincir/Difficulty.html","kind":"module","full_name":"Zincir::Difficulty","name":"Difficulty","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/difficulty.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"PRECISION","name":"PRECISION","value":"4","doc":"Number of non zero characters at the end of the difficulty\n\n````\n\"000000f\" # precision 1\n\"004f0\" # precision 3\n\"0014f0\" # precision 4\n\"14f000\" # precision 6\n````","summary":"<p>Number of non zero characters at the end of the difficulty</p>"}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[{"id":"calculate(current_difficulty:String,duration,desired_duration)-class-method","html_id":"calculate(current_difficulty:String,duration,desired_duration)-class-method","name":"calculate","doc":"Returns the adjusted difficulty for the given *duration* and *desired_duration*","summary":"<p>Returns the adjusted difficulty for the given <em>duration</em> and <em>desired_duration</em></p>","abstract":false,"args":[{"name":"current_difficulty","doc":null,"default_value":"","external_name":"current_difficulty","restriction":"String"},{"name":"duration","doc":null,"default_value":"","external_name":"duration","restriction":""},{"name":"desired_duration","doc":null,"default_value":"","external_name":"desired_duration","restriction":""}],"args_string":"(current_difficulty : String, duration, desired_duration)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L20","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L20","def":{"name":"calculate","args":[{"name":"current_difficulty","doc":null,"default_value":"","external_name":"current_difficulty","restriction":"String"},{"name":"duration","doc":null,"default_value":"","external_name":"duration","restriction":""},{"name":"desired_duration","doc":null,"default_value":"","external_name":"desired_duration","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"ratio = desired_duration / duration\nif ratio > 1.1 || ratio < 0.9\n  multiply(current_difficulty, ratio)\nelse\n  current_difficulty\nend\n"}},{"id":"dec_to_hex(dec)-class-method","html_id":"dec_to_hex(dec)-class-method","name":"dec_to_hex","doc":null,"summary":null,"abstract":false,"args":[{"name":"dec","doc":null,"default_value":"","external_name":"dec","restriction":""}],"args_string":"(dec)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L74","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L74","def":{"name":"dec_to_hex","args":[{"name":"dec","doc":null,"default_value":"","external_name":"dec","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"while dec > (16 ** PRECISION)\n  dec = dec / 16\nend\nhex = dec.to_s(16)\nwhile hex.size < PRECISION\n  hex = '0' + hex\nend\nhex\n"}},{"id":"hex_to_dec(hex)-class-method","html_id":"hex_to_dec(hex)-class-method","name":"hex_to_dec","doc":"Converts hext to decimal ignoring leading 0s\nAdds trailing f as necessary to match the precision","summary":"<p>Converts hext to decimal ignoring leading 0s Adds trailing f as necessary to match the precision</p>","abstract":false,"args":[{"name":"hex","doc":null,"default_value":"","external_name":"hex","restriction":""}],"args_string":"(hex)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L58","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L58","def":{"name":"hex_to_dec","args":[{"name":"hex","doc":null,"default_value":"","external_name":"hex","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"while hex.starts_with?(\"0\")\n  hex = hex[1..-1]\nend\nwhile hex.size > PRECISION\n  hex = hex[0..-2]\nend\nwhile hex.size < PRECISION\n  hex = hex + \"f\"\nend\nhex.to_i(16)\n"}},{"id":"multiply(difficulty,multiplier)-class-method","html_id":"multiply(difficulty,multiplier)-class-method","name":"multiply","doc":null,"summary":null,"abstract":false,"args":[{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"multiplier","doc":null,"default_value":"","external_name":"multiplier","restriction":""}],"args_string":"(difficulty, multiplier)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L36","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L36","def":{"name":"multiply","args":[{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""},{"name":"multiplier","doc":null,"default_value":"","external_name":"multiplier","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"zero_count = 0\ndifficulty.chars.each do |char|\n  if char == '0'\n  else\n    break\n  end\n  zero_count = zero_count + 1\nend\ndecimal = hex_to_dec(difficulty)\nproduct = decimal / multiplier\nwhile product > (16 ** PRECISION)\n  product = product / 16\n  zero_count = zero_count - 1\nend\nhex_product = dec_to_hex(product.to_i)\n(\"0\" * zero_count) + hex_product\n"}},{"id":"satisfies?(hash,difficulty)-class-method","html_id":"satisfies?(hash,difficulty)-class-method","name":"satisfies?","doc":"Returs true if the given *hash* satisfies the given *difficulty*","summary":"<p>Returs true if the given <em>hash</em> satisfies the given <em>difficulty</em></p>","abstract":false,"args":[{"name":"hash","doc":null,"default_value":"","external_name":"hash","restriction":""},{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""}],"args_string":"(hash, difficulty)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L14","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L14","def":{"name":"satisfies?","args":[{"name":"hash","doc":null,"default_value":"","external_name":"hash","restriction":""},{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"hash_difficulty = hash[0..(difficulty.size - 1)].to_i64(16)\nhash_difficulty <= (difficulty.to_i64(16))\n"}},{"id":"valid?(difficulty)-class-method","html_id":"valid?(difficulty)-class-method","name":"valid?","doc":"Returns true if the given `String` is a valid *difficulty*\n\nTODO: Implement","summary":"<p>Returns true if the given <code>String</code> is a valid <em>difficulty</em></p>","abstract":false,"args":[{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""}],"args_string":"(difficulty)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L33","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/difficulty.cr#L33","def":{"name":"valid?","args":[{"name":"difficulty","doc":null,"default_value":"","external_name":"difficulty","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}}],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","path":"Zincir/Emitter.html","kind":"module","full_name":"Zincir::Emitter(T)","name":"Emitter","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/emitter.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/emitter.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Blockchain","kind":"class","full_name":"Zincir::Blockchain","name":"Blockchain"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Network","kind":"class","full_name":"Zincir::Network","name":"Network"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Node","kind":"class","full_name":"Zincir::Node","name":"Node"}],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"emit(event,block)-instance-method","html_id":"emit(event,block)-instance-method","name":"emit","doc":null,"summary":null,"abstract":false,"args":[{"name":"event","doc":null,"default_value":"","external_name":"event","restriction":""},{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"args_string":"(event, block)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/emitter.cr#L9","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/emitter.cr#L9","def":{"name":"emit","args":[{"name":"event","doc":null,"default_value":"","external_name":"event","restriction":""},{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@callbacks.try(&.[](event)).try(&.each do |callback|\n  callback.call(block)\nend)"}},{"id":"on(event,&hook:T)-instance-method","html_id":"on(event,&amp;hook:T)-instance-method","name":"on","doc":null,"summary":null,"abstract":false,"args":[{"name":"event","doc":null,"default_value":"","external_name":"event","restriction":""}],"args_string":"(event, &hook : T)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/emitter.cr#L3","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/emitter.cr#L3","def":{"name":"on","args":[{"name":"event","doc":null,"default_value":"","external_name":"event","restriction":""}],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"hook","doc":null,"default_value":"","external_name":"hook","restriction":"T"},"return_type":"","visibility":"Public","body":"@callbacks || (@callbacks = {} of Symbol => Array(T))\n__temp_40 = event\n__temp_41 = @callbacks.not_nil!\n__temp_41[__temp_40]? || (__temp_41[__temp_40] = [] of T)\n@callbacks.not_nil![event] << hook\n"}}],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Miner","path":"Zincir/Miner.html","kind":"module","full_name":"Zincir::Miner","name":"Miner","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/miner.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/miner.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[{"id":"start!(blockchain)-class-method","html_id":"start!(blockchain)-class-method","name":"start!","doc":"Starts mining the blockchain","summary":"<p>Starts mining the blockchain</p>","abstract":false,"args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""}],"args_string":"(blockchain)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/miner.cr#L4","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/miner.cr#L4","def":{"name":"start!","args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"new_block_channel = Channel(Bool).new\nblockchain.on(:block) do |block|\n  new_block_channel.send(true)\nend\nindex_changed = false\nspawn do\n  loop do\n    index_changed = new_block_channel.receive\n  end\nend\nloop do\n  begin\n    last_block = blockchain.last\n    difficulty = blockchain.next_difficulty\n    index = blockchain.next_index.to_s\n    data = \"Transaction Data... #{Random.rand(100)}\"\n    timestamp = Time.now.to_unix.to_s\n    nonce = -1\n    index_changed = false\n    loop do\n      nonce = nonce + 1\n      hash = Block.calculate_hash(nonce.to_s, index, timestamp, data, last_block.hash)\n      if Difficulty.satisfies?(hash, difficulty)\n        break\n      end\n      if index_changed\n        break\n      end\n      Fiber.yield\n    end\n    if index_changed\n      next\n    end\n    block = Block.new(index.to_i, timestamp.to_i64, data, last_block.hash, difficulty, nonce)\n    blockchain.queue_block(block)\n  rescue Blockchain::BlockNotAdded\n  end\nend\n"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Network","path":"Zincir/Network.html","kind":"class","full_name":"Zincir::Network","name":"Network","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/network.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"TESTNET_SEED_HOST","name":"TESTNET_SEED_HOST","value":"\"testnet.zincir.xyz:9147\"","doc":null,"summary":null}],"included_modules":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(seed_node_ip=nil)-class-method","html_id":"new(seed_node_ip=nil)-class-method","name":"new","doc":"Creates the `Network` with the given *seed_node_ip* as the first node.\n\nSpawns a fiber that periodically explores the connected nodes for new nodes.","summary":"<p>Creates the <code><a href=\"../Zincir/Network.html\">Network</a></code> with the given <em>seed_node_ip</em> as the first node.</p>","abstract":false,"args":[{"name":"seed_node_ip","doc":null,"default_value":"nil","external_name":"seed_node_ip","restriction":""}],"args_string":"(seed_node_ip = <span class=\"n\">nil</span>)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L13","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L13","def":{"name":"new","args":[{"name":"seed_node_ip","doc":null,"default_value":"nil","external_name":"seed_node_ip","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(seed_node_ip)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"add_node(websocket:HTTP::WebSocket)-instance-method","html_id":"add_node(websocket:HTTP::WebSocket)-instance-method","name":"add_node","doc":"Creates a new `Node` with the given *websocket* connection","summary":"<p>Creates a new <code><a href=\"../Zincir/Node.html\">Node</a></code> with the given <em>websocket</em> connection</p>","abstract":false,"args":[{"name":"websocket","doc":null,"default_value":"","external_name":"websocket","restriction":"HTTP::WebSocket"}],"args_string":"(websocket : HTTP::WebSocket)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L20","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L20","def":{"name":"add_node","args":[{"name":"websocket","doc":null,"default_value":"","external_name":"websocket","restriction":"HTTP::WebSocket"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"add_node(Node.new(websocket))"}},{"id":"add_node(ip:String)-instance-method","html_id":"add_node(ip:String)-instance-method","name":"add_node","doc":"Creates a new `Node` with the given *ip* if it hasn't been connected to already","summary":"<p>Creates a new <code><a href=\"../Zincir/Node.html\">Node</a></code> with the given <em>ip</em> if it hasn't been connected to already</p>","abstract":false,"args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":"String"}],"args_string":"(ip : String)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L25","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L25","def":{"name":"add_node","args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if @nodes.map(&.ip).includes?(ip)\n  return\nend\nif @host_ip == ip\n  return\nend\nadd_node(Node.new(ip))\n"}},{"id":"add_node(node:Node)-instance-method","html_id":"add_node(node:Node)-instance-method","name":"add_node","doc":"Adds the given node to the `Network`","summary":"<p>Adds the given node to the <code><a href=\"../Zincir/Network.html\">Network</a></code></p>","abstract":false,"args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"Node"}],"args_string":"(node : Node)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L34","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L34","def":{"name":"add_node","args":[{"name":"node","doc":null,"default_value":"","external_name":"node","restriction":"Node"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"node.on(:block) do |block|\n  emit(:block, block)\nend\nnode.on_close do\n  @nodes.delete(node)\n  puts(\"Connection is closed #{node.ip} (#{@nodes.size})\")\nend\n@nodes << node\nputs(\"New connection #{node} (#{@nodes.size})\")\n"}},{"id":"block_at(index)-instance-method","html_id":"block_at(index)-instance-method","name":"block_at","doc":null,"summary":null,"abstract":false,"args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"args_string":"(index)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L73","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L73","def":{"name":"block_at","args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"public_nodes.sample.block_at(index)"}},{"id":"blocks_at(indexes)-instance-method","html_id":"blocks_at(indexes)-instance-method","name":"blocks_at","doc":null,"summary":null,"abstract":false,"args":[{"name":"indexes","doc":null,"default_value":"","external_name":"indexes","restriction":""}],"args_string":"(indexes)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L77","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L77","def":{"name":"blocks_at","args":[{"name":"indexes","doc":null,"default_value":"","external_name":"indexes","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"public_nodes.sample.blocks_at(indexes)"}},{"id":"broadcast_block(block)-instance-method","html_id":"broadcast_block(block)-instance-method","name":"broadcast_block","doc":null,"summary":null,"abstract":false,"args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"args_string":"(block)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L61","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L61","def":{"name":"broadcast_block","args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@nodes.each do |node|\n  begin\n    node.broadcast_block(block)\n  rescue\n    next\n  end\nend"}},{"id":"broadcast_host_ip(ip)-instance-method","html_id":"broadcast_host_ip(ip)-instance-method","name":"broadcast_host_ip","doc":null,"summary":null,"abstract":false,"args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":""}],"args_string":"(ip)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L53","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L53","def":{"name":"broadcast_host_ip","args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@host_ip = ip\n@nodes.each do |node|\n  node.broadcast_host_ip(ip)\nend\n"}},{"id":"last_block-instance-method","html_id":"last_block-instance-method","name":"last_block","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L69","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L69","def":{"name":"last_block","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"public_nodes.sample.last_block"}},{"id":"public_nodes-instance-method","html_id":"public_nodes-instance-method","name":"public_nodes","doc":"Returns a list connected public node","summary":"<p>Returns a list connected public node</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L49","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/network.cr#L49","def":{"name":"public_nodes","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@nodes.select(&.public?)"}}],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Node","path":"Zincir/Node.html","kind":"class","full_name":"Zincir::Node","name":"Node","abstract":false,"superclass":{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/oguzbilgic/zincir-crystal/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"zincir/node.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Emitter","kind":"module","full_name":"Zincir::Emitter","name":"Emitter"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(ip:String)-class-method","html_id":"new(ip:String)-class-method","name":"new","doc":"Creates a `Node` with the given *ip* and connects via websocket","summary":"<p>Creates a <code><a href=\"../Zincir/Node.html\">Node</a></code> with the given <em>ip</em> and connects via websocket</p>","abstract":false,"args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":"String"}],"args_string":"(ip : String)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L14","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L14","def":{"name":"new","args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(ip)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}},{"id":"new(socket:HTTP::WebSocket,ip=nil)-class-method","html_id":"new(socket:HTTP::WebSocket,ip=nil)-class-method","name":"new","doc":"Creates a `Node` with the given *socket* connection","summary":"<p>Creates a <code><a href=\"../Zincir/Node.html\">Node</a></code> with the given <em>socket</em> connection</p>","abstract":false,"args":[{"name":"socket","doc":null,"default_value":"","external_name":"socket","restriction":"HTTP::WebSocket"},{"name":"ip","doc":null,"default_value":"nil","external_name":"ip","restriction":""}],"args_string":"(socket : HTTP::WebSocket, ip = <span class=\"n\">nil</span>)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L26","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L26","def":{"name":"new","args":[{"name":"socket","doc":null,"default_value":"","external_name":"socket","restriction":"HTTP::WebSocket"},{"name":"ip","doc":null,"default_value":"nil","external_name":"ip","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(socket, ip)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"block_at(index)-instance-method","html_id":"block_at(index)-instance-method","name":"block_at","doc":null,"summary":null,"abstract":false,"args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"args_string":"(index)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L88","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L88","def":{"name":"block_at","args":[{"name":"index","doc":null,"default_value":"","external_name":"index","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"response = HTTP::Client.get(\"http://#{@ip}/blocks/#{index}\")\nBlock.from_json(response.body)\n"}},{"id":"blocks_at(indexes:Range|Array(Int32))-instance-method","html_id":"blocks_at(indexes:Range|Array(Int32))-instance-method","name":"blocks_at","doc":null,"summary":null,"abstract":false,"args":[{"name":"indexes","doc":null,"default_value":"","external_name":"indexes","restriction":"Range | Array(Int32)"}],"args_string":"(indexes : Range | Array(Int32))","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L94","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L94","def":{"name":"blocks_at","args":[{"name":"indexes","doc":null,"default_value":"","external_name":"indexes","restriction":"Range | Array(Int32)"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"indexes = indexes.is_a?(Range) ? indexes.to_s : indexes.join(',')\nresponse = HTTP::Client.get(\"http://#{@ip}/blocks/#{indexes}\")\nArray(Block).from_json(response.body)\n"}},{"id":"broadcast_block(block)-instance-method","html_id":"broadcast_block(block)-instance-method","name":"broadcast_block","doc":null,"summary":null,"abstract":false,"args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"args_string":"(block)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L64","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L64","def":{"name":"broadcast_block","args":[{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"message = Message.new(block: block)\n@socket.send(message.to_json)\n"}},{"id":"broadcast_host_ip(ip)-instance-method","html_id":"broadcast_host_ip(ip)-instance-method","name":"broadcast_host_ip","doc":null,"summary":null,"abstract":false,"args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":""}],"args_string":"(ip)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L70","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L70","def":{"name":"broadcast_host_ip","args":[{"name":"ip","doc":null,"default_value":"","external_name":"ip","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"message = Message.new(ip: ip)\n@socket.send(message.to_json)\n"}},{"id":"connected?-instance-method","html_id":"connected?-instance-method","name":"connected?","doc":"Returns true if the `#socket` is open","summary":"<p>Returns true if the <code>#socket</code> is open</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L56","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L56","def":{"name":"connected?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"!@socket.closed?"}},{"id":"ip:String?-instance-method","html_id":"ip:String?-instance-method","name":"ip","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String?","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L11","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L11","def":{"name":"ip","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@ip"}},{"id":"known_ips-instance-method","html_id":"known_ips-instance-method","name":"known_ips","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L76","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L76","def":{"name":"known_ips","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"response = HTTP::Client.get(\"http://#{@ip}/nodes\")\nArray(String).from_json(response.body)\n"}},{"id":"last_block-instance-method","html_id":"last_block-instance-method","name":"last_block","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L82","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L82","def":{"name":"last_block","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"response = HTTP::Client.get(\"http://#{@ip}/blocks\")\nBlock.from_json(response.body)\n"}},{"id":"on_close(&block)-instance-method","html_id":"on_close(&amp;block)-instance-method","name":"on_close","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"(&block)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L44","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L44","def":{"name":"on_close","args":[],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"block","doc":null,"default_value":"","external_name":"block","restriction":""},"return_type":"","visibility":"Public","body":"@socket.on_close do\n  block.call\nend"}},{"id":"public?-instance-method","html_id":"public?-instance-method","name":"public?","doc":"Returns true if the `Node` is publicly accessible via it's `#ip`","summary":"<p>Returns true if the <code><a href=\"../Zincir/Node.html\">Node</a></code> is publicly accessible via it's <code><a href=\"../Zincir/Node.html#ip%3AString%3F-instance-method\">#ip</a></code></p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L51","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L51","def":{"name":"public?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@ip != nil"}},{"id":"to_s(io)-instance-method","html_id":"to_s(io)-instance-method","name":"to_s","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"args_string":"(io)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L60","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/node.cr#L60","def":{"name":"to_s","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"io << @ip"}}],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Storage","path":"Zincir/Storage.html","kind":"module","full_name":"Zincir::Storage","name":"Storage","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/storage/file.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/file.cr"},{"filename":"zincir/storage/network.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Storage/File","path":"Zincir/Storage/File.html","kind":"module","full_name":"Zincir::Storage::File","name":"File","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/storage/file.cr","line_number":3,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/file.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Storage","kind":"module","full_name":"Zincir::Storage","name":"Storage"},"doc":null,"summary":null,"class_methods":[{"id":"load_and_sync(blockchain)-class-method","html_id":"load_and_sync(blockchain)-class-method","name":"load_and_sync","doc":null,"summary":null,"abstract":false,"args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""}],"args_string":"(blockchain)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/file.cr#L4","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/file.cr#L4","def":{"name":"load_and_sync","args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if ::File.exists?(\".blocks\")\nelse\n  Dir.mkdir(\".blocks\")\nend\nblockchain.on(:block) do |block|\n  ::File.write(\".blocks/#{block.hash}\", block.to_json)\nend\nblocks = (Dir.open(\".blocks/\")).children.map do |filename|\n  file = ::File.read(\".blocks/#{filename}\")\n  Block.from_json(file)\nend\nblock_size = blocks.size\nblocks = blocks.sort_by!(&.index)\nloop do\n  begin\n    if blocks.empty?\n      break\n    end\n    block = blocks.shift\n    blockchain.queue_block(block)\n  rescue Blockchain::BlockNotPreferred\n    puts(\"Notpreferred #{block}\")\n  rescue Blockchain::BlockOnForkChain\n    puts(\"BlockOnForkChain #{block}\")\n  end\nend\nputs(\"#{block_size} blocks are read from the file system\")\nputs(\"Finished reading the chain from file system\")\n"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Storage/Network","path":"Zincir/Storage/Network.html","kind":"module","full_name":"Zincir::Storage::Network","name":"Network","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/storage/network.cr","line_number":3,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Storage/Network","kind":"module","full_name":"Zincir::Storage::Network","name":"Network"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Storage","kind":"module","full_name":"Zincir::Storage","name":"Storage"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"check_sync_status(blockchain,network)-instance-method","html_id":"check_sync_status(blockchain,network)-instance-method","name":"check_sync_status","doc":null,"summary":null,"abstract":false,"args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""}],"args_string":"(blockchain, network)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr#L90","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr#L90","def":{"name":"check_sync_status","args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"puts(\"Checking network sync status...\")\nsleep(5)\nlast_network = network.last_block\nour_block = blockchain.last\nif last_network.hash != our_block.hash\n  raise(\"Not in sync\")\nend\nputs(\"Blockchain is in sync with the network\")\n"}},{"id":"find_mutual_block(blockchain,network,lowest)-instance-method","html_id":"find_mutual_block(blockchain,network,lowest)-instance-method","name":"find_mutual_block","doc":null,"summary":null,"abstract":false,"args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""},{"name":"lowest","doc":null,"default_value":"","external_name":"lowest","restriction":""}],"args_string":"(blockchain, network, lowest)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr#L49","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr#L49","def":{"name":"find_mutual_block","args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""},{"name":"lowest","doc":null,"default_value":"","external_name":"lowest","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"loop do\n  our_block = blockchain.block_at(lowest)\n  net_block = network.block_at(lowest)\n  if our_block.hash == net_block.hash\n    return our_block\n  end\n  lowest = lowest - 1\nend"}},{"id":"load_and_sync(blockchain,network)-instance-method","html_id":"load_and_sync(blockchain,network)-instance-method","name":"load_and_sync","doc":null,"summary":null,"abstract":false,"args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""}],"args_string":"(blockchain, network)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr#L6","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/storage/network.cr#L6","def":{"name":"load_and_sync","args":[{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"received_block_hashes = [] of String\nnetwork.on(:block) do |block|\n  begin\n    blockchain.queue_block(block)\n    if received_block_hashes.includes?(block.hash)\n      next\n    end\n    received_block_hashes << block.hash\n    network.broadcast_block(block)\n  rescue e\n    puts(\"Network error: #{e}\")\n  end\nend\nif network.public_nodes.empty?\n  puts(\"Can't download or broadcast to network, no public nodes\")\n  return\nend\nblockchain_last = blockchain.last\nnetwork_last = network.last_block\nif blockchain_last.hash != network_last.hash\n  puts(\"Doesn't have same last block\")\n  lowest = Math.min(blockchain_last.index, network_last.index)\n  mutual_block = find_mutual_block(blockchain, network, lowest)\n  if blockchain_last.index > network_last.index\n    broadcast(blockchain, network, mutual_block.index + 1)\n  else\n    if blockchain_last.index <= network_last.index\n      download(blockchain, network, mutual_block.index)\n    end\n  end\nend\ncheck_sync_status(blockchain, network)\nblockchain.on(:block) do |block|\n  if received_block_hashes.includes?(block.hash)\n    next\n  end\n  network.broadcast_block(block)\nend\n"}}],"macros":[],"types":[]}]},{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir/Web","path":"Zincir/Web.html","kind":"module","full_name":"Zincir::Web","name":"Web","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"zincir/web.cr","line_number":2,"url":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/web.cr"}],"repository_name":"github.com/oguzbilgic/zincir-crystal","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"DEFAULT_IP","name":"DEFAULT_IP","value":"\"localhost\"","doc":null,"summary":null},{"id":"DEFAULT_PORT","name":"DEFAULT_PORT","value":"9147","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/oguzbilgic/zincir-crystal/Zincir","kind":"module","full_name":"Zincir","name":"Zincir"},"doc":null,"summary":null,"class_methods":[{"id":"start!(network,blockchain,port=nil,ip=nil)-class-method","html_id":"start!(network,blockchain,port=nil,ip=nil)-class-method","name":"start!","doc":null,"summary":null,"abstract":false,"args":[{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""},{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"port","doc":null,"default_value":"nil","external_name":"port","restriction":""},{"name":"ip","doc":null,"default_value":"nil","external_name":"ip","restriction":""}],"args_string":"(network, blockchain, port = <span class=\"n\">nil</span>, ip = <span class=\"n\">nil</span>)","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/web.cr#L6","source_link":"https://github.com/oguzbilgic/zincir-crystal/blob/88e6b31930a9a16725a72c15a6f1030c9286614a/src/zincir/web.cr#L6","def":{"name":"start!","args":[{"name":"network","doc":null,"default_value":"","external_name":"network","restriction":""},{"name":"blockchain","doc":null,"default_value":"","external_name":"blockchain","restriction":""},{"name":"port","doc":null,"default_value":"nil","external_name":"port","restriction":""},{"name":"ip","doc":null,"default_value":"nil","external_name":"ip","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"logging(false)\nbefore_all do |env|\n  env.response.headers.add(\"Access-Control-Allow-Origin\", \"*\")\nend\nget(\"/nodes\") do\n  network.public_nodes.map(&.ip).to_json\nend\nget(\"/blocks\") do\n  blockchain.last.to_json\nend\nget(\"/tips\") do\n  blockchain.try do |__arg1|\n    __arg1.tips.to_json\n  end\nend\nget(\"/blocks/:input\") do |env|\n  input = env.params.url[\"input\"]\n  if input.includes?(',')\n    indexes = (input.split(',')).map(&.to_i).uniq\n    (blockchain.blocks_at(indexes)).to_json\n  else\n    if input.includes?(\"..\")\n      ranges = input.split(\"..\")\n      range = ranges.first.to_i..ranges.last.to_i\n      (blockchain.blocks_at(range)).to_json\n    else\n      (blockchain.block_at(input.to_i)).to_json\n    end\n  end\nend\nws(\"/blocks\") do |socket, env|\n  network.add_node(socket)\nend\nport || (port = DEFAULT_PORT)\nif ip\n  puts(\"Starting & broadcasting web server at #{ip}:#{port}\")\n  network.broadcast_host_ip(\"#{ip}:#{port}\")\nelse\n  ip = DEFAULT_IP\n  puts(\"Starting local web server at #{ip}:#{port}\")\nend\nKemal.run(port)\n"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[]}]}]}})